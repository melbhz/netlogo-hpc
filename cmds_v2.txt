#These are scripts we used to run a demo example

#make a copy of TEMPLATES folder
cd /data/gpfs/projects/punim1439/workflow/Demo
cp -r TEMPLATES Test_24Mar
cd /data/gpfs/projects/punim1439/workflow/Demo/Test_24Mar

#Okay, commit 56ccc is now the last commit, so
git clone https://github.com/population-interventions/COVIDModel.git

bash create_xmls.sh

#check which partition has more available cpus
spartan-weather

sbatch submit_jobarray_snowy.slurm

showq -u

squeue -u jthooker

cd /data/gpfs/projects/punim1439/workflow/Demo/Test_24Mar
mkdir slurms
mv ./slurm-*.out ./slurms/

cd /data/gpfs/projects/punim1439/workflow/Demo/Test_24Mar/outputs_snowy
awk '(NR < 8) || (FNR > 7)' *_table_*.csv > MergedResults.csv
head mergedresult.csv

##//////////cancel job by jobid, jobname, partition, or username//////////##
scancel -j 24700701
scancel -n COVIDModel-snowy
scancel -p snowy
scancel -A jthooker
##////////////////////////////////////////////////////////////////////////##

#make a copy of slurm file, revise, and run again on another partition
cp submit_jobarray_snowy.slurm submit_jobarray_physical.slurm
nano submit_jobarray_physical.slurm
sbatch submit_jobarray_physical.slurm

showq -u

#cancel the job
scancel -n COVIDModel-physical

chmod -v g=rw my_filename_that_need_add_readwrite_permission_for_group_members
